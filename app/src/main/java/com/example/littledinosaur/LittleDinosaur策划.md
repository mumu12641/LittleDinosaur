# LittleDinosaur策划

### 1.数据库设计

用户数据库内容： id（自增长） 密码   邮箱  extra

extra中计划加一些现在未能想到的内容，预计用json数组添加内容

### 2.服务器设计

注册时获取验证码 通过flask服务器完成

每次安装应用 通过服务器将数据库所有的用户信息加载到用户手机当中

### 3.注册设计

在输入完邮箱之后点击获取验证码的按钮，就Post自己的邮箱地址到服务器，服务器处理之后发送邮件给用户，用户输入验证码之后再确认注册即可Post自己的所有数据到服务器，并且把自己的数据存入本地数据库。

### 4.登录设计

在本地数据库中进行校验（由于）

### 5.用户主界面

从登录界面传递用户的UserName过来，用于显示。

#### 1.用户信息修改

在mysetting界面修改了自己的name之后，POST自己的邮件信息和新修改的name信息到服务器，服务器修改json文件。

通过startactivityresult启动用户信息设置界面，返回的时候接受修改的name重新显示。

更改数据库中的名字

### 6.首页界面功能

每次进入HomeActivity之后要向服务器发送请求 获取服务器中的所有树洞帖子 并且按照我们的最新更新时间排序

点击加号进入activity编辑好了之后发表就可以将信息POST到服务器 包括帖子的序号（如#00001）、发帖人姓名、发帖内容、发帖时间、最近更新时间（第一次发表即为发帖时间，之后如果由评论或者点赞就视为更新获取新的更新时间）、点赞数、评论数以及每个评论的时间、内容等。

编辑完了之后回到首页界面的时候我们就自动刷新一次向服务器请求数据

***10/26日更新 我在实现树洞消息更新的时候是如此实现的：我们进入写树洞activity的时候都把我们本身的homeactivity给finish掉，返回的时候重新创建这个activity，实现了homefragment的重建，而每次homefragment重建的时候我们都是在服务器获取数据布局界面，因此而实现了树洞消息的刷新。***

***但是还有另外一个方法，还是使用startactivityforresult，返回到homeactivity的时候我们就将homefragmen转为null，并且模拟点击home实现重建（成功）***

<u>***11/3 TODO（完成）***</u>

***重构了treeholemessage类加入一些新内容，每次用户在writetreeholemessageactivity中写完内容发送到服务器的时候，需要重构POST的内容以及将服务器端的Json文件重构一下***



***<u>点赞评论收藏设计</u>（完成）***

***在homefragment中点击点赞按钮即可，此时POST点赞的用户的姓名到服务器，treeholemessage的json文件中的likes加一，重绘这一个adapter（成功）。***

***同时新建一个对应messageid的json文件其中储存点击点赞的人的用户名 评论的用户用户名以及评论内容和时间	json文件设计 {"likesmessageuser": [{"1": "Infinity Studio Administrator"}], "commentsmessageuser": [], "commentscontent": [], "commentstime": [],"commentstime": []}***	

***取消点赞返回服务器（完成）***



***评论功能（完成）***

***暂时打算使用气泡的形式实现评论，打算实现一个adapter，类中应该存有评论的内容，评论发送的时间，评论者的头像（这里选择不显示头像了  以区别于洞主的帖子），评论者的名字等。计划形式如同洞主的消息形式。***

***每次发送评论应该把上述信息发送到服务器（暂时不设置评论的点赞收藏以及删除功能）***

**刷新功能 如同首页的刷新功能 计划返回每一个adpter 然后显示 读取#00001中的文件来读取并且返回**



***<u>11/11&11/13 TODO</u>***

***头像的设计（可能要拖到很后面）***

***点赞评论收藏的时候更新时间*** ***希望时间精确到分钟（完成 下一步记得更新时间）***

***评论界面的气泡线条更改更好看点***

***学习动画知识，优化开机动画（放弃 越弄越丑）***



***11/17***

***今天看了一下RecyclerView性能优化，点击事件要重新弄，然后每次获取用户是否点赞或者收藏的时候需要的时间很长，导致刷新卡顿，需要优化***	

***11/18更新***

***点击事件已经重新写了一下，然后就是获取点赞收藏我计划在服务器中再创建一个文件夹里面存各个用户点过赞或者收过藏的messageid在获取treeholemessage的时候初始化imgid的时候获取*** 



***11/21修复bug以及TODO***

***（1）修复数据库读取密码为integer的错误，改成text	（√）***

***（2）注册界面获取验证码的反馈问题	（√）***

***（3）写树洞界面的返回之后首页无内容的问题	（√）***

**（4）*HUAWEI*　Ｐ４０闪退　（*可能是自动登录作怪*？）**

***（5）实现根据更新时间排列帖子，然后打tag***

***（６）进入ａｐｐ之后没能链接上服务器显示提示	（√）***

***（７）消息******提示评论和点赞***

***（８）关键词搜索***

***11/27更新***

**今天完成了一下自动更新的内容 每次进入MainActivity的时候就检查一次版本，如果版本号与服务器的版本不相符就进入安装的activity，下载文件并进行安装（这里的安装是需要用户自行安装		以后有时间做自动安装）**

***每次注册之后不能登录 还是在注册之后再GetUser一次比较保险***

### 7.发现界面功能

今日天气 课程表 备忘录 知乎热榜 微博热榜 哔哩哔哩热榜 csdn热榜 今天吃什么 童年OP 每天夸夸 跳蚤市场

### 8.其他

**自动登录（重要）**

舍弃头像

下方标题栏变小一点	√

顶部标题栏 标题文字居左	√

色调为黑白灰	√